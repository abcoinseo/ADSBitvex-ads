<div class="flex items-center justify-center p-4 min-h-[250px] w-[300px] overflow-hidden">
  @if (loading()) {
    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200 text-center flex flex-col items-center w-full h-full justify-center">
      <svg class="animate-spin h-8 w-8 text-indigo-500 mb-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      <p class="text-gray-600 text-sm">Loading ad...</p>
    </div>
  } @else if (error()) {
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md relative w-full h-full flex items-center justify-center" role="alert">
      <strong class="font-bold">Error!</strong>
      <span class="block sm:inline ml-2">{{ error() }}</span>
    </div>
  } @else if (currentAd()) {
    <div class="bg-gray-800 rounded-xl shadow-2xl overflow-hidden max-w-sm w-full h-full flex flex-col justify-between">
      <!-- "Take Your Reward" Header Section -->
      <div class="reward-header bg-cover bg-center p-6 text-center relative flex flex-col items-center justify-center min-h-[120px] rounded-t-xl">
        <!-- This is a placeholder for the gold coins background effect -->
        <!-- Using a direct image URL as an example, replace with a better asset if available -->
        <img ngSrc="https://images.unsplash.com/photo-1594240212903-8551a37c093a?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80"
             fill="true" priority="true" alt="Gold coins background" class="absolute inset-0 object-cover opacity-60">
        <div class="relative z-10">
          <h2 class="text-4xl font-black text-amber-400 uppercase tracking-wide drop-shadow-lg mb-2">
            Take Your Reward
          </h2>
          <i class="material-icons text-amber-400 text-3xl drop-shadow-lg">keyboard_arrow_down</i>
        </div>
      </div>

      <!-- Ad Content and Button Section -->
      <div class="p-4 flex flex-col items-center gap-4 bg-white flex-grow">
        <p class="text-gray-700 text-sm text-center">{{ currentAd()!.description }}</p>
        <button
          (click)="onAdClick()"
          [disabled]="isButtonDisabled()"
          class="w-full px-6 py-3 bg-blue-600 text-white font-bold rounded-lg text-lg transition duration-300 ease-in-out
                 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500
                 "
          [class.opacity-50]="isButtonDisabled()"
          [class.cursor-not-allowed]="isButtonDisabled()"
        >
          {{ currentAd()!.buttonText }} <i class="material-icons text-base align-middle ml-1">arrow_forward</i>
        </button>

        @if (showRewardMessage()) {
          <div class="bg-green-500 text-white px-4 py-2 rounded-full text-sm font-semibold flex items-center justify-center transition-all duration-300 ease-in-out shadow-md">
            @if (countdown() > 0) {
              <i class="material-icons text-sm mr-2">timer</i> Reward in {{ countdown() }} seconds...
            } @else {
              <i class="material-icons text-sm mr-2">check_circle_outline</i> Click to get the reward!
            }
          </div>
        }
      </div>
    </div>
  } @else {
    <div class="bg-gray-100 p-6 rounded-lg shadow-md border border-gray-200 text-center flex flex-col items-center w-full h-full justify-center">
      <i class="material-icons text-5xl text-gray-400 mb-3">block</i>
      <p class="text-gray-600 text-sm">No ads available at this time.</p>
    </div>
  }
</div>